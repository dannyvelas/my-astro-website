---
import BaseLayout from "../layouts/BaseLayout.astro";
import _ from "lodash";
import fp from "lodash/fp";

const posts = (await Astro.glob("../pages/posts/*.md")).map((post) => ({
  ...post,
  year: new Date(post.frontmatter.publishedDate).getFullYear(),
}));
const years = fp.flow(
  fp.groupBy(fp.iteratee("year")),
  fp.values,
  fp.map((x) => ({ year: x[0].year, posts: x })),
  fp.orderBy(fp.iteratee("key"))("desc")
)(posts);
---

<BaseLayout title="Danny Velasquez's Base Posts">
  <p class="mb-4">
    Hi! My name is Danny. I currently work as a software engineer and team lead
    at Walmart. I like learning about programming languages, software design
    patterns, and system development. I plan to post here some of the thoughts
    that I have and some of the things I'm interested in.
  </p>
  <h2 class="text-2xl mt-8 mb-4">Posts</h2>
  <ul>
    {
      years.map((year) => (
        <>
          <p>{year.year}</p>
          <hr />
          {year.posts.map((post) => (
            <li>
              <a class="hover:underline" href={post.url}>
                {post.frontmatter.title}
              </a>
            </li>
          ))}
        </>
      ))
    }
  </ul>
</BaseLayout>
