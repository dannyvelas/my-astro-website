---
import BaseLayout from "../layouts/BaseLayout.astro";
import _ from "lodash/fp";

const posts = await Astro.glob("../pages/posts/*.md");
const years = _.flow(
  _.map((x) => ({
    ...x,
    year: new Date(x.frontmatter.publishedDate).getFullYear(),
  })),
  _.groupBy(_.iteratee("year")),
  _.values,
  _.map((x) => ({ year: x[0].year, posts: x })),
  _.orderBy(_.iteratee("key"))("desc")
)(posts);
---

<BaseLayout title="Danny Velasquez's Base Posts">
  <p class="mb-4">
    Hi! My name is Danny. I currently work as a software engineer and team lead
    at Walmart. I like learning about programming languages, software design
    patterns, and system development. I plan to post here some of the thoughts
    that I have and some of the things I'm interested in.
  </p>
  <h2 class="text-2xl mt-8 mb-4">Posts</h2>
  <ul>
    {
      years.map((year) => (
        <>
          <h3 class="text-gray-700">{year.year}</h3>
          <hr />
          <ul class="my-4">
            {year.posts.map((post) => (
              <li class="my-2">
                <a class="hover:underline" href={post.url}>
                  {post.frontmatter.title}
                </a>
              </li>
            ))}
          </ul>
        </>
      ))
    }
  </ul>
</BaseLayout>
